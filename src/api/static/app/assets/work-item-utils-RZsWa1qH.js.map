{"version":3,"file":"work-item-utils-RZsWa1qH.js","sources":["../../../../ui/lib/work-item-utils.ts"],"sourcesContent":["/**\n * Shared utility functions and constants for work item display.\n *\n * Used by page components to render consistent status icons, priority\n * colors, and kind indicators across the application.\n */\nimport type {\n  WorkItemStatus,\n  WorkItemPriority,\n  WorkItemKind,\n} from '@/ui/components/detail/types';\nimport type { TreeItem, TreeItemKind } from '@/ui/components/tree/types';\nimport type { WorkItemTreeNode } from '@/ui/lib/api-types';\n\n/** CSS class map for priority badge backgrounds. */\nexport const priorityColors: Record<string, string> = {\n  P0: 'bg-red-500 text-white',\n  P1: 'bg-orange-500 text-white',\n  P2: 'bg-yellow-500 text-white',\n  P3: 'bg-green-500 text-white',\n  P4: 'bg-gray-500 text-white',\n};\n\n/** CSS class map for kind badge backgrounds. */\nexport const kindColors: Record<string, string> = {\n  project: 'bg-blue-500',\n  initiative: 'bg-violet-500',\n  epic: 'bg-emerald-500',\n  issue: 'bg-gray-500',\n};\n\n/** SVG fill class map for kinds (used in timeline charts). */\nexport const kindFillColors: Record<string, string> = {\n  project: 'fill-violet-500',\n  initiative: 'fill-blue-500',\n  epic: 'fill-green-500',\n  issue: 'fill-amber-500',\n};\n\n/** Map API priority strings (P0-P4) to component priority type. */\nexport function mapApiPriority(priority: string): WorkItemPriority {\n  const mapping: Record<string, WorkItemPriority> = {\n    P0: 'urgent',\n    P1: 'high',\n    P2: 'medium',\n    P3: 'low',\n    P4: 'low',\n  };\n  return mapping[priority] ?? 'medium';\n}\n\n/** Map component priority type back to API priority string. */\nexport function mapPriorityToApi(priority: WorkItemPriority): string {\n  const mapping: Record<WorkItemPriority, string> = {\n    urgent: 'P0',\n    high: 'P1',\n    medium: 'P2',\n    low: 'P3',\n  };\n  return mapping[priority] ?? 'P2';\n}\n\n/**\n * Recursively map API tree nodes to component TreeItem format.\n * Converts snake_case API fields to the camelCase format expected by ProjectTree.\n */\nexport function mapApiTreeToTreeItems(apiItems: WorkItemTreeNode[]): TreeItem[] {\n  return apiItems.map((item) => ({\n    id: item.id,\n    title: item.title,\n    kind: item.kind as TreeItemKind,\n    status: item.status as 'not_started' | 'in_progress' | 'blocked' | 'done' | 'cancelled',\n    parentId: item.parent_id,\n    childCount: item.children_count,\n    children: item.children.length > 0 ? mapApiTreeToTreeItems(item.children) : undefined,\n  }));\n}\n\n/** Find a tree item by ID, searching recursively through children. */\nexport function findTreeItem(items: TreeItem[], id: string): TreeItem | null {\n  for (const item of items) {\n    if (item.id === id) return item;\n    if (item.children) {\n      const found = findTreeItem(item.children, id);\n      if (found) return found;\n    }\n  }\n  return null;\n}\n\n/**\n * Flatten a tree into a list of potential parent items for the move dialog.\n * Returns id, title, and kind for each item in the hierarchy.\n */\nexport function flattenTreeForParents(\n  items: TreeItem[],\n): Array<{ id: string; title: string; kind: string }> {\n  const result: Array<{ id: string; title: string; kind: string }> = [];\n  const traverse = (treeItems: TreeItem[]): void => {\n    for (const treeItem of treeItems) {\n      result.push({ id: treeItem.id, title: treeItem.title, kind: treeItem.kind });\n      if (treeItem.children) {\n        traverse(treeItem.children);\n      }\n    }\n  };\n  traverse(items);\n  return result;\n}\n\n/** Read the bootstrap JSON injected by the server into the page. */\nexport function readBootstrap<T = Record<string, unknown>>(): T | null {\n  const el = document.getElementById('app-bootstrap');\n  if (!el) return null;\n  const text = el.textContent;\n  if (!text) return null;\n\n  try {\n    return JSON.parse(text) as T;\n  } catch {\n    return null;\n  }\n}\n\n/** Format minutes into a human-readable duration string. */\nexport function formatDuration(minutes: number): string {\n  if (minutes >= 60) {\n    return `${Math.floor(minutes / 60)}h`;\n  }\n  return `${minutes}m`;\n}\n\n/** Get initials from a display name (max 2 characters). */\nexport function getInitials(name: string): string {\n  return name\n    .split(' ')\n    .map((n) => n[0])\n    .join('')\n    .toUpperCase()\n    .slice(0, 2);\n}\n"],"names":["priorityColors","kindColors","kindFillColors","mapApiPriority","priority","mapPriorityToApi","mapApiTreeToTreeItems","apiItems","item","findTreeItem","items","id","found","flattenTreeForParents","result","traverse","treeItems","treeItem","readBootstrap","el","text","getInitials","name","n"],"mappings":"AAeO,MAAMA,EAAyC,CACpD,GAAI,wBACJ,GAAI,2BACJ,GAAI,2BACJ,GAAI,0BACJ,GAAI,wBACN,EAGaC,EAAqC,CAChD,QAAS,cACT,WAAY,gBACZ,KAAM,iBACN,MAAO,aACT,EAGaC,EAAyC,CACpD,QAAS,kBACT,WAAY,gBACZ,KAAM,iBACN,MAAO,gBACT,EAGO,SAASC,EAAeC,EAAoC,CAQjE,MAPkD,CAChD,GAAI,SACJ,GAAI,OACJ,GAAI,SACJ,GAAI,MACJ,GAAI,KAAA,EAESA,CAAQ,GAAK,QAC9B,CAGO,SAASC,EAAiBD,EAAoC,CAOnE,MANkD,CAChD,OAAQ,KACR,KAAM,KACN,OAAQ,KACR,IAAK,IAAA,EAEQA,CAAQ,GAAK,IAC9B,CAMO,SAASE,EAAsBC,EAA0C,CAC9E,OAAOA,EAAS,IAAKC,IAAU,CAC7B,GAAIA,EAAK,GACT,MAAOA,EAAK,MACZ,KAAMA,EAAK,KACX,OAAQA,EAAK,OACb,SAAUA,EAAK,UACf,WAAYA,EAAK,eACjB,SAAUA,EAAK,SAAS,OAAS,EAAIF,EAAsBE,EAAK,QAAQ,EAAI,MAAA,EAC5E,CACJ,CAGO,SAASC,EAAaC,EAAmBC,EAA6B,CAC3E,UAAWH,KAAQE,EAAO,CACxB,GAAIF,EAAK,KAAOG,EAAI,OAAOH,EAC3B,GAAIA,EAAK,SAAU,CACjB,MAAMI,EAAQH,EAAaD,EAAK,SAAUG,CAAE,EAC5C,GAAIC,EAAO,OAAOA,CACpB,CACF,CACA,OAAO,IACT,CAMO,SAASC,EACdH,EACoD,CACpD,MAAMI,EAA6D,CAAA,EAC7DC,EAAYC,GAAgC,CAChD,UAAWC,KAAYD,EACrBF,EAAO,KAAK,CAAE,GAAIG,EAAS,GAAI,MAAOA,EAAS,MAAO,KAAMA,EAAS,IAAA,CAAM,EACvEA,EAAS,UACXF,EAASE,EAAS,QAAQ,CAGhC,EACA,OAAAF,EAASL,CAAK,EACPI,CACT,CAGO,SAASI,GAAuD,CACrE,MAAMC,EAAK,SAAS,eAAe,eAAe,EAClD,GAAI,CAACA,EAAI,OAAO,KAChB,MAAMC,EAAOD,EAAG,YAChB,GAAI,CAACC,EAAM,OAAO,KAElB,GAAI,CACF,OAAO,KAAK,MAAMA,CAAI,CACxB,MAAQ,CACN,OAAO,IACT,CACF,CAWO,SAASC,EAAYC,EAAsB,CAChD,OAAOA,EACJ,MAAM,GAAG,EACT,IAAKC,GAAMA,EAAE,CAAC,CAAC,EACf,KAAK,EAAE,EACP,cACA,MAAM,EAAG,CAAC,CACf"}